<mvc:View
    id="viewProjects"
    controllerName="uiprojectmanagement.controller.View1"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:t="sap.ui.table"
    xmlns:core="sap.ui.core"
    xmlns:gantt="sap.gantt.simple"
    displayBlock="true"
    height="100%">

    <f:DynamicPage id="pageProjects" fitContent="true">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="Project Portfolio Management" level="H1"/>
                </f:heading>
                <f:expandedContent>
                    <Label text="Visualize project timelines, tasks, and milestones."/>
                </f:expandedContent>
                <f:actions>
                    <Button text="Assign Resource" icon="sap-icon://add-contact" type="Emphasized" press="onOpenResourceFinder"/>
                    <Button icon="sap-icon://refresh" tooltip="Refresh Data" press="onInit"/>
                </f:actions>
            </f:DynamicPageTitle>
        </f:title>

        <f:content>
            <VBox fitContainer="true" height="100%">
                
                <gantt:GanttChartContainer id="ganttContainer" height="100%">
                    
                    <gantt:toolbar>
                        <gantt:ContainerToolbar>
                            <gantt:content>
                                <Title text="Timeline View" level="H3"/>
                                <ToolbarSpacer/>
                                <Button icon="sap-icon://zoom-in" tooltip="Zoom In" press="onZoomIn"/>
                                <Button icon="sap-icon://zoom-out" tooltip="Zoom Out" press="onZoomOut"/>
                                <Button icon="sap-icon://legend" tooltip="Show Legend" press="onShowLegend"/>
                            </gantt:content>
                        </gantt:ContainerToolbar>
                    </gantt:toolbar>
                    
                    <gantt:ganttCharts>
                        <gantt:GanttChartWithTable id="ganttChart" shapeDrop="onShapeDrop">
                            <gantt:table>
                                <t:TreeTable
                                    id="TreeTable"
                                    selectionMode="Single"
                                    rows="{
                                        path: '/root',
                                        parameters: {
                                            arrayNames: ['children']
                                        }
                                    }">
                                    <t:columns>
                                        <t:Column id="wbsColStructure" label="WBS Structure" width="22rem">
                                            <t:template>
                                                <HBox alignItems="Center">
                                                    <core:Icon 
                                                        src="{= ${type} === 'Project' ? 'sap-icon://business-objects-experience' : 'sap-icon://clipboard'}" 
                                                        color="{= ${type} === 'Project' ? '#0070b4' : '#6a6d70' }"
                                                        size="1.2rem"
                                                        class="sapUiTinyMarginEnd"/>
                                                    <VBox>
                                                        <Text text="{title}" design="{= ${type} === 'Project' ? 'Bold' : 'Standard'}" wrapping="false"/>
                                                        <Label text="{= ${type} === 'Project' ? 'Project' : (${isMilestone} ? 'Milestone' : 'Task') }" 
                                                               design="Standard" class="sapUiTinyMarginTop"/>
                                                    </VBox>
                                                </HBox>
                                            </t:template>
                                        </t:Column>

                                        <t:Column id="wbsColStatus" label="Status" width="8rem" hAlign="Center">
                                            <t:template>
                                                <ObjectStatus 
                                                    text="{= ${type} === 'Task' ? ${statusOrProgress} + '%' : ${statusOrProgress}}"
                                                    state="{= ${statusOrProgress} === 'Completed' || ${statusOrProgress} === '100' ? 'Success' : (${statusOrProgress} === 'Active' ? 'Information' : 'None') }"
                                                    icon="{= ${isMilestone} ? 'sap-icon://flag' : ''}"/>
                                            </t:template>
                                        </t:Column>
                                    </t:columns>

                                    <t:rowSettingsTemplate>
                                        <gantt:GanttRowSettings id="ganttRowSettings">
                                            <gantt:shapes1>
                                                
                                                <gantt:BaseRectangle 
                                                    shapeId="{ID}"
                                                    time="{startDate}" 
                                                    endTime="{endDate}" 
                                                    title="{title}"
                                                    tooltip="{title}" 
                                                    fill="#fac364" 
                                                    visible="{= ${type} === 'Project' }"/>

                                                <gantt:BaseRectangle 
                                                    shapeId="{ID}"
                                                    time="{startDate}" 
                                                    endTime="{endDate}" 
                                                    title="{title}"
                                                    tooltip="{title}"
                                                    fill="#3fa7d6" 
                                                    visible="{= ${type} === 'Task' &amp;&amp; !${isMilestone} }"/>

                                                <gantt:BaseDiamond
                                                    shapeId="{ID}"
                                                    time="{startDate}"
                                                    title="{title}"
                                                    tooltip="{title}"
                                                    fill="#4d4d4d"
                                                    visible="{= ${type} === 'Task' &amp;&amp; ${isMilestone} }"/>

                                            </gantt:shapes1>
                                        </gantt:GanttRowSettings>
                                    </t:rowSettingsTemplate>

                                </t:TreeTable>
                            </gantt:table>
                        </gantt:GanttChartWithTable>
                    </gantt:ganttCharts>
                </gantt:GanttChartContainer>

            </VBox>
        </f:content>
    </f:DynamicPage>
</mvc:View>